{
  "hash": "e2a125ae896741f4fa6ff240bdc744db",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Dataset-2: Movie Profits\"\n---\n\n\n\n# Movie Profits\n\nLet's set up our document with libraries first.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(mosaic)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRegistered S3 method overwritten by 'mosaic':\n  method                           from   \n  fortify.SpatialPolygonsDataFrame ggplot2\n\nThe 'mosaic' package masks several functions from core packages in order to add \nadditional features.  The original behavior of these functions should not be affected by this.\n\nAttaching package: 'mosaic'\n\nThe following object is masked from 'package:Matrix':\n\n    mean\n\nThe following objects are masked from 'package:dplyr':\n\n    count, do, tally\n\nThe following object is masked from 'package:purrr':\n\n    cross\n\nThe following object is masked from 'package:ggplot2':\n\n    stat\n\nThe following objects are masked from 'package:stats':\n\n    binom.test, cor, cor.test, cov, fivenum, IQR, median, prop.test,\n    quantile, sd, t.test, var\n\nThe following objects are masked from 'package:base':\n\n    max, mean, min, prod, range, sample, sum\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(skimr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'skimr'\n\nThe following object is masked from 'package:mosaic':\n\n    n_missing\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggformula)\n```\n:::\n\n\n\nNow, let's import the dataset.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmovie <- read_delim(file = \"../../data/movie_profit.csv\",delim =\";\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 3310 Columns: 10\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \";\"\nchr  (4): movie, distributor, mpaa_rating, genre\ndbl  (4): production_budget, domestic_gross, worldwide_gross, decade\nnum  (1): profit_ratio\ndate (1): release_date\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(movie)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 3,310\nColumns: 10\n$ release_date      <date> 2005-07-22, 1998-08-28, 1997-03-28, 2000-07-14, 201…\n$ movie             <chr> \"November\", \"I Married a Strange Person\", \"Love and …\n$ production_budget <dbl> 250000, 250000, 250000, 250000, 250000, 250000, 2500…\n$ domestic_gross    <dbl> 191862, 203134, 212285, 1055671, 3395391, 3802390, 3…\n$ worldwide_gross   <dbl> 191862, 203134, 743216, 1157672, 3728400, 3809226, 3…\n$ distributor       <chr> \"Other\", \"Other\", \"Other\", \"Other\", \"Paramount Pictu…\n$ mpaa_rating       <chr> \"R\", NA, \"R\", \"R\", \"PG-13\", \"R\", \"R\", \"R\", \"R\", \"R\",…\n$ genre             <chr> \"Drama\", \"Comedy\", \"Comedy\", \"Drama\", \"Drama\", \"Dram…\n$ profit_ratio      <dbl> 7.674480e+13, 8.125360e+13, 2.972864e+14, 4.630688e+…\n$ decade            <dbl> 2000, 1990, 1990, 2000, 2010, 2000, 2010, 2000, 2010…\n```\n\n\n:::\n\n```{.r .cell-code}\nview(movie)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nskim(movie)\n```\n\n::: {.cell-output-display}\n\nTable: Data summary\n\n|                         |      |\n|:------------------------|:-----|\n|Name                     |movie |\n|Number of rows           |3310  |\n|Number of columns        |10    |\n|_______________________  |      |\n|Column type frequency:   |      |\n|character                |4     |\n|Date                     |1     |\n|numeric                  |5     |\n|________________________ |      |\n|Group variables          |None  |\n\n\n**Variable type: character**\n\n|skim_variable | n_missing| complete_rate| min| max| empty| n_unique| whitespace|\n|:-------------|---------:|-------------:|---:|---:|-----:|--------:|----------:|\n|movie         |         0|          1.00|   1|  35|     0|     3310|          0|\n|distributor   |        42|          0.99|   5|  18|     0|        6|          0|\n|mpaa_rating   |       130|          0.96|   1|   5|     0|        4|          0|\n|genre         |         0|          1.00|   5|   9|     0|        5|          0|\n\n\n**Variable type: Date**\n\n|skim_variable | n_missing| complete_rate|min        |max        |median     | n_unique|\n|:-------------|---------:|-------------:|:----------|:----------|:----------|--------:|\n|release_date  |         0|             1|1936-02-05 |2017-12-22 |2005-06-30 |     1723|\n\n\n**Variable type: numeric**\n\n|skim_variable     | n_missing| complete_rate|         mean|           sd|       p0|          p25|          p50|          p75|         p100|hist  |\n|:-----------------|---------:|-------------:|------------:|------------:|--------:|------------:|------------:|------------:|------------:|:-----|\n|production_budget |         0|             1| 3.326794e+07| 3.460741e+07| 2.50e+05| 9.500000e+06| 2.000000e+07| 4.500000e+07| 1.750000e+08|▇▂▁▁▁ |\n|domestic_gross    |         0|             1| 4.551509e+07| 5.852794e+07| 0.00e+00| 6.530094e+06| 2.558731e+07| 6.046695e+07| 4.745447e+08|▇▁▁▁▁ |\n|worldwide_gross   |         0|             1| 9.384123e+07| 1.389514e+08| 4.23e+02| 1.086144e+07| 4.040903e+07| 1.184703e+08| 1.162782e+09|▇▁▁▁▁ |\n|profit_ratio      |         0|             1| 4.319388e+14| 1.501736e+15| 1.38e+10| 7.861269e+13| 1.962499e+14| 3.942158e+14| 4.315179e+16|▇▁▁▁▁ |\n|decade            |         0|             1| 1.998790e+03| 1.061000e+01| 1.93e+03| 1.990000e+03| 2.000000e+03| 2.010000e+03| 2.010000e+03|▁▁▁▃▇ |\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ninspect(movie)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\ncategorical variables:  \n         name     class levels    n missing\n1       movie character   3310 3310       0\n2 distributor character      6 3268      42\n3 mpaa_rating character      4 3180     130\n4       genre character      5 3310       0\n                                   distribution\n1 10 Days in a Madhouse (0%) ...               \n2  Other (53.2%), Warner Bros. (11%) ...       \n3 R (46.4%), PG-13 (33.5%), PG (17.4%) ...     \n4 Drama (36.5%), Comedy (24.1%) ...            \n\nDate variables:  \n          name class      first       last min_diff  max_diff    n missing\n1 release_date  Date 1936-02-05 2017-12-22   0 days 2592 days 3310       0\n\nquantitative variables:  \n               name   class      min           Q1       median           Q3\n1 production_budget numeric 2.50e+05 9.500000e+06 2.000000e+07 4.500000e+07\n2    domestic_gross numeric 0.00e+00 6.530094e+06 2.558731e+07 6.046695e+07\n3   worldwide_gross numeric 4.23e+02 1.086144e+07 4.040903e+07 1.184703e+08\n4      profit_ratio numeric 1.38e+10 7.861269e+13 1.962499e+14 3.942158e+14\n5            decade numeric 1.93e+03 1.990000e+03 2.000000e+03 2.010000e+03\n           max         mean           sd    n missing\n1 1.750000e+08 3.326794e+07 3.460741e+07 3310       0\n2 4.745447e+08 4.551509e+07 5.852794e+07 3310       0\n3 1.162782e+09 9.384123e+07 1.389514e+08 3310       0\n4 4.315179e+16 4.319388e+14 1.501736e+15 3310       0\n5 2.010000e+03 1.998785e+03 1.061308e+01 3310       0\n```\n\n\n:::\n:::\n\n\n\n## Data Dictionary\n\n### Qualitative Variables\n\n-   ***movie (chr):*** Name of the movie.\n\n-   ***distributor (chr):*** company that is distributing the movie (fct).\n\n-   ***mpaa_rating (chr):*** movie rating (fct).\n\n-   ***genre (chr):*** movie genre (fct).\n\n-   ***decade (chr):*** movie genre.\n\n### Quantitative Variables\n\n-   ***release_date (date):*** date of release.\n\n-   ***production_budget (dbl):*** budget for production of the movie.\n\n-   ***domestic_gross (dbl):*** gross income for the movie in domestic box office.\n\n-   ***worldwide_gross (dbl):*** gross income for the movie in international box office.\n\n-   ***profit_ratio (dbl):*** ratio of profit.\n\nThis dataset has equal numbers of qual as well as quant variables. **profit_ratio is the target variable** here, whereas **genre** and **distributor** are the potential **predictor variables**.\n\nNow, I will mutate some variables and turn them into factors.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmovie_modified <- movie %>% \n  mutate(\n    distributor = as.factor(distributor),\n    mpaa_rating = as.factor(mpaa_rating),\n    genre = as.factor(genre),\n    decade = as.factor(decade)\n  )\n\nglimpse(movie_modified)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 3,310\nColumns: 10\n$ release_date      <date> 2005-07-22, 1998-08-28, 1997-03-28, 2000-07-14, 201…\n$ movie             <chr> \"November\", \"I Married a Strange Person\", \"Love and …\n$ production_budget <dbl> 250000, 250000, 250000, 250000, 250000, 250000, 2500…\n$ domestic_gross    <dbl> 191862, 203134, 212285, 1055671, 3395391, 3802390, 3…\n$ worldwide_gross   <dbl> 191862, 203134, 743216, 1157672, 3728400, 3809226, 3…\n$ distributor       <fct> Other, Other, Other, Other, Paramount Pictures, Para…\n$ mpaa_rating       <fct> R, NA, R, R, PG-13, R, R, R, R, R, R, R, PG-13, NA, …\n$ genre             <fct> Drama, Comedy, Comedy, Drama, Drama, Drama, Action, …\n$ profit_ratio      <dbl> 7.674480e+13, 8.125360e+13, 2.972864e+14, 4.630688e+…\n$ decade            <fct> 2000, 1990, 1990, 2000, 2010, 2000, 2010, 2000, 2010…\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(movie_modified)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3,310 × 10\n   release_date movie           production_budget domestic_gross worldwide_gross\n   <date>       <chr>                       <dbl>          <dbl>           <dbl>\n 1 2005-07-22   November                   250000         191862          191862\n 2 1998-08-28   I Married a St…            250000         203134          203134\n 3 1997-03-28   Love and Other…            250000         212285          743216\n 4 2000-07-14   Chuck&Buck                 250000        1055671         1157672\n 5 2011-10-28   Like Crazy                 250000        3395391         3728400\n 6 2003-04-11   Better Luck To…            250000        3802390         3809226\n 7 2017-04-28   Sleight                    250000        3930990         3934450\n 8 2002-06-28   Lovely and Ama…            250000        4210379         4613482\n 9 2012-08-17   Compliance                 270000         319285          830700\n10 2005-05-06   Fighting Tommy…            300000          10514           10514\n# ℹ 3,300 more rows\n# ℹ 5 more variables: distributor <fct>, mpaa_rating <fct>, genre <fct>,\n#   profit_ratio <dbl>, decade <fct>\n```\n\n\n:::\n:::\n\n\n\n### What research activity might have been carried out to obtain the data graphed here?\n\n-   The first one would be internet browsing. Availing data from sources like imdb, wikipedia, etc.\n\n-   Let's say that an individual was very excited and enthusiastic about obtaining this dataset. They might have visited their nearest movie theaters every friday to get the movie names. For an enquiry to become a data set, it has to start somewhere with some variable.\n\n-   More enthusiasm would've led them to call a production house and ask questions regarding the budget.\n\n### What might be the Hypothesis / Research Question, based on the Chart?\n\n-   do profit margins for different genres vary across major film distributors?\n\n-   which genres are more profitable for each of the distributors?\n\n-   How does the distributor \"N/A\" compare to the other big distributors?\n\n-   What is the comparison between domestic gross and international gross of the movies?\n\n-   what has been the trend in production budget across decades?\n\n-   which genre had most profit in each decade?\n\nLet's replicate the graph now.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmovie_modified %>%\n  group_by(distributor, genre) %>%                 \n  \n  summarise(median_profit_ratio = median(profit_ratio, na.rm = TRUE)) %>%  \n  ggplot(aes(x = genre, y = median_profit_ratio)) +  \n  geom_bar(stat = \"identity\", fill = \"darkgray\") +   \n  facet_wrap(~ distributor) +                        \n  coord_flip() +                                     \n  labs(\n    title = \"Profits made by Film Distributors\",\n    subtitle = \"Ratio of Profits to Budgets\",\n    x = \"Genre\", \n    y = \"Median Profit Ratio\",\n    caption = \"Tidy Tuesday Oct 23, 2018\"\n  ) +\n  theme_minimal() +                                  \n  theme(\n    strip.text = element_text(face = \"bold\"),        \n    plot.title = element_text(face = \"bold\", size = 16)  \n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`summarise()` has grouped output by 'distributor'. You can override using the\n`.groups` argument.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n**\\[KINDLY NOTE: I have taken the help of chatgpt to replicate this graph as I was unable to figure it out myself.\\]**\n\nThis is a bar graph!\n\n### Observations\n\n-   All distributors have at least one genre that they make most profit from.\n\n-   'Action' genre is most successful in very small scale distributors named 'N/A'.\n\n-   20th century fox has the most uniform distribution of profit margin across all genres.\n\n-   'Drama' seems to have the equal profitability margin across all distributors.\n\n-   'Action', 'Adventure', and 'Horror' generally have the done the most profit across all distributors.\n\n### What pre-processing of the data was required to create the chart?\n\nUse of delimiter in order to separate the columns.\n\n### Inference\n\nSince genres like action, adventure, and horror have uniform profits across all distributors, it is therefore more probable to make profitable movies belonging to these genres.\n\nBig distributors like 20th century fox and universal studios usually manage to make profits out of any of the said genre regardless of the rating.\n\nif one cannot get hold of these big distributors, the best way to break through would be to make action movies and sell them all across small distributors.\n\n### Story\n\nThe company that had started out as \"Comedy Spread\" was doing wonders just a decade ago. Their light-hearted films and rom-com hits had audiences laughing all the way to the box office. However, times have changed now. People prefer action over drama and comedy (I can’t seem to understand why). With every passing year, their profits from action-packed blockbusters soared. It’s as if audiences crave the thrill of explosions, chases, and stunts more than ever. \"Comedy Spread\" finds itself at a crossroads—will they change themselves to survive in this market, or will they stick to their roots, hoping the world rekindles its love for a good laugh? Only time will tell.\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}